upstream splinter {
    server splinter:3000;
}

upstream leonardo {
    server leonardo:8002;
}

upstream rabbitmq {
    server rabbitmq:15672;
}

server {
    listen 80;

    location /static {
    alias /opt/leonardo/staticfiles;
    }
    location / {
        proxy_pass http://splinter ;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header Host $host;
        proxy_redirect off;
    }
    location /admin {
        proxy_pass http://leonardo/admin;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header Host $host;
        proxy_redirect off;
    }
}

server {
    listen 15672;
    location / {
        proxy_pass http://rabbitmq;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header Host $host;
        proxy_redirect off;
    }
}